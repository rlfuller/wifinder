(function(){var e=angular.module("wifinderApp",["ngRoute","ngSanitize","ui.bootstrap"]);function o(e,o,t){e.when("/",{controller:"homeController",templateUrl:"home/home.view.html"}).when("/about",{templateUrl:"/common/views/genericText.view.html",controller:"aboutController"}).when("/location/:locationid",{templateUrl:"/locationDetail/locationDetail.view.html",controller:"locationDetailController"}).otherwise({redirectTo:"/"});o.html5Mode(true).hashPrefix("");t.resourceUrlWhitelist(["self","https://maps.google.com/**"])}e.config(["$routeProvider","$locationProvider","$sceDelegateProvider",o])})();(function(){var e=function(e,o,t){e.pageHeader={title:"WIFInder",strapline:"Find places to work with wifi near you!"};e.sidebar={content:"Looking for wifi and a seat? WIFInder helps you find places to work when out and about. Perhaps with coffee, food, or a beer? Let WIFInder help you find the place you are looking for."};e.message="Checking your location";e.getData=function(t){var n=t.coords.latitude,r=t.coords.longitude;e.message="Searching for nearby places";o.locationByCoords(n,r).then(function(o){e.message=o.data.length>0?"":"No locations found nearby";e.level="info";e.data=o.data;console.log(e.message.length)},function(o){e.message="Sorry, something's gone wrong";e.level="warning"})};console.log("rachel",e);e.showError=function(o){e.$apply(function(){e.message=o.message;e.level="warning"})};e.noGeo=function(){e.$apply(function(){e.message="Geolocation is not supported by this browser.";e.level="warning"})};t.getPosition(e.getData,e.showError,e.noGeo)};angular.module("wifinderApp").controller("homeController",["$scope","wifinderData","geolocation",e])})();(function(){function e(e){e.pageHeader={title:"About WIFInder"};e.main={content:"WIFInder was created to help people find places to sit and get work done. \n\nLorem ipsum dolor sit amet, dicant perfecto scripserit eu sit, Omnis dicunt ex per, probatus disputando philosophia pro an, sit cu velit virtute. Eam ad saepe vidisse feugiat, his te delicata torquatos, detracto electram sapientem ne vix mea sale concludaturque ex, in vis perfecto repudiandae. "}}angular.module("wifinderApp").controller("aboutController",["$scope",e])})();(function(){function e(e,o,t,n){e.locationid=o.locationid;n.locationById(e.locationid).then(function(o){e.response={location:o.data};console.log(e.response);e.pageHeader={title:o.data.name};e.getIframeSrc="https://maps.google.com/maps?q=("+e.response.location.coords[1]+","+e.response.location.coords[0]+")&output=embed"},function(e){console.log(e)});e.popupReviewForm=function(){var o=t.open({templateUrl:"/reviewModal/reviewModal.view.html",controller:"reviewModalController",resolve:{locationData:function(){return{locationid:e.locationid,locationName:e.response.location.name}}}});o.result.then(function(o){e.response.location.reviews.push(o.data)})}}angular.module("wifinderApp").controller("locationDetailController",["$scope","$routeParams","$uibModal","wifinderData",e])})();(function(){function e(e,o,t,n){e.modal={cancel:function(){o.dismiss("cancel")},close:function(e){o.close(e)}};e.locationData=n;console.log("tom",e);e.onSubmit=function(){console.log("this form has been submitted");e.formError="";if(!e.formData.name||!e.formData.rating||!e.formData.reviewText){e.formError="All fields required, please try again";return false}else{e.doAddReview(e.locationData.locationid,e.formData);return false}};e.doAddReview=function(o,n){t.addReviewById(o,{author:e.formData.name,rating:e.formData.rating,reviewText:e.formData.reviewText}).then(function(o){console.log("Success");e.modal.close(o)},function(o){e.formError="Your review has not been saved, try again."});return false}}angular.module("wifinderApp").controller("reviewModalController",["$scope","$uibModalInstance","wifinderData","locationData",e])})();(function(){var e=function(){var e=function(e,o,t){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(e,o)}else{t()}};return{getPosition:e}};angular.module("wifinderApp").service("geolocation",[e])})();(function(){var e=function(e){var o=function(o,t){return e.get("/api/locations?lng="+t+"&lat="+o)};var t=function(o){return e.get("/api/locations/"+o)};var n=function(o,t){return e.post("/api/locations/"+o+"/reviews",t)};return{locationByCoords:o,locationById:t,addReviewById:n}};angular.module("wifinderApp").service("wifinderData",["$http",e])})();(function(){function e(){return function(e){var o,t;o=parseInt(e,10).toFixed(2);o=Number(o/1609.344).toFixed(2);t="mi";return o+t}}angular.module("wifinderApp").filter("formatDistance",e)})();(function(){function e(){return function(e){var o=e.replace(/\n/g,"<br/>");return o}}angular.module("wifinderApp").filter("addHtmlLineBreaks",e)})();(function(){var e=function(){return{restrict:"EA",scope:{thisRating:"=rating"},templateUrl:"/common/directives/ratingStars/rating-stars.html"}};angular.module("wifinderApp").directive("ratingStars",e)})();(function(){function e(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric/footerGeneric.template.html"}}angular.module("wifinderApp").directive("footerGeneric",e)})();(function(){function e(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html"}}angular.module("wifinderApp").directive("navigation",e)})();(function(){function e(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader/pageHeader.template.html"}}angular.module("wifinderApp").directive("pageHeader",e)})();